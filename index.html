<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>玖数学的方程组</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        body { font-family: Arial, sans-serif; background-color: lightblue; }
        #title { text-align: center; margin-top: 10px; }
        #game-container { margin: 30px; text-align: center; }
        #equation { font-size: 2em; text-align: center; margin: 20px; }
        #options { text-align: center; margin: 20px; }
        .option { display: inline-block; margin: 0 10px; padding: 10px; border: 1px solid #000; cursor: pointer;margin: 0 10px 20px; }
        #scoreboard { text-align: center; margin: 20px; }
        #rounds-scoreboard { text-align: center; margin: 20px; }
    </style>
</head>
<body>
    <div id="title">
        <h1>玖数学的方程组</h1>
        <h2>解方程组A1:</h2>
    </div>
    <div id="game-container">
        <div id="equation"></div>
        <div id="options"></div>
        <div id="scoreboard">现在得分:<span id="score">0</span>,已回答:<span id="answered">0</span></div>
    </div>
  

    <div style="text-align: center; margin-top: 10px;">
        <button onclick="displayEquationSystem();score = 0; questionsAnswered = 0;updateScoreboard(); ">重新开始</button>
        <button onclick="clearScores();displayEquationSystem();score = 0; questionsAnswered = 0;updateScoreboard();">清除所有</button>
    </div>
     <div id="rounds-scoreboard"> <span id="rounds-scores"></span></div>

    <script>
        const maxQuestions = 10;
        let questionsAnswered = 0;
        let score = 0;
        let correctOptionIndex;
        let roundsScores = [];

        function generateCoefficient1() {
            return Math.floor(Math.random() * 2) + 1;
        }
        function generateCoefficient2() {
            return Math.floor(Math.random() * 5) + 1;
        }
        function generateSolution() {
            return Math.floor(Math.random() * 6) - 0;
        }
        function formatCoefficient(coefficient, isFirstTerm = false) {
            if (coefficient === 1) return isFirstTerm ? '' : '+';
            if (coefficient === -1) return '-';
            return isFirstTerm && coefficient > 0 ? `${coefficient}` : `${coefficient > 0 ? '+' : ''}${coefficient}`;
        }
        function generateEquationSystem() {
            let a, b, d, e, x, y, c, f;
            do {
                a = generateCoefficient1();
                b = generateCoefficient2();
                d = generateCoefficient1();
                e = generateCoefficient2();
                x = generateSolution();
                y = generateSolution();
                c = a * x + b * y;
                f = d * x + e * y;
            } while (a * e === b * d);
            const equation1 = `${formatCoefficient(a, true)}x ${formatCoefficient(b)}y = ${c}`;
            const equation2 = `${formatCoefficient(d, true)}x ${formatCoefficient(e)}y = ${f}`;
            return { equationSystem: `\\[\\begin{cases} ${equation1}  \\\\ ${equation2}\\end{cases}\\quad\\genfrac{}{}{0pt}{}{①}{②} \\]`, correctX: x, correctY: y };
        }
        function generateOptions(correctX, correctY) {
            let options = [{ x: correctX, y: correctY }];
            while (options.length < 4) {
                let incorrectAnswer = { x: generateSolution(), y: generateSolution() };
                if (incorrectAnswer.x !== correctX || incorrectAnswer.y !== correctY) {
                    options.push(incorrectAnswer);
                }
            }
            options.sort(() => Math.random() - 0.5);
            correctOptionIndex = options.findIndex(option => option.x === correctX && option.y === correctY);
            return options;
        }

        function displayOptions(options) {
            const labels = ['A', 'B', 'C', 'D'];
            const optionsHTML = options.map((option, index) =>
                `<div class="option" onclick="checkAnswer(${index})">${labels[index]}. \\(\\left\\{ \\begin{array}{l} x = ${option.x} \\\\ y = ${option.y} \\end{array} \\right.\\)</div>`
            ).join('');
            document.getElementById('options').innerHTML = optionsHTML;
            MathJax.typesetPromise();
        }
        function displayEquationSystem() {
            const { equationSystem, correctX, correctY } = generateEquationSystem();
            document.getElementById('equation').innerHTML = equationSystem;
            MathJax.typesetPromise();
            const options = generateOptions(correctX, correctY);
            displayOptions(options);
        }
        function updateScoreboard() {
            document.getElementById('score').textContent = score;
            document.getElementById('answered').textContent = questionsAnswered;
        }


        function updateRoundsScoreboard() {
            let roundsScoresText = roundsScores.map((roundScore, index) => `第${index + 1}轮: ${roundScore}分共10题`).join('<br>');
            document.getElementById('rounds-scores').innerHTML= roundsScoresText;
        }


        function checkAnswer(selectedIndex) {
            if (selectedIndex === correctOptionIndex) {
                score++;
            }
            questionsAnswered++;
            if (questionsAnswered >= maxQuestions) {
                roundsScores.push(score);
                questionsAnswered = 0;
                score = 0;
                displayEquationSystem();
                updateRoundsScoreboard();
            } else {
                displayEquationSystem();
            }
            updateScoreboard();
        }

function clearScores() {
    roundsScores = []; // 清空得分数组
    updateRoundsScoreboard(); // 更新显示
}



        window.onload = displayEquationSystem;
    </script>
</body>
</html>
